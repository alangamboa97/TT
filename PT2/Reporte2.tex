\documentclass[12pt,letterpaper]{article}
\usepackage[spanish]{babel}
\usepackage{amsmath}
\usepackage[latin1]{inputenc}
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{anysize}
\usepackage{array}
\usepackage{multicol}
\usepackage{lmodern}
\usepackage{adjustbox}
\usepackage{enumitem}
\usepackage{float}
\marginsize{2cm}{2cm}{1cm}{1cm}
\usepackage{fancyhdr}

\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\footnotesize UPIITA}
%\fancyfoot[R]{\footnotesize Diseño}
\fancyfoot[R]{\thepage}
\fancyfoot[L]{\footnotesize Proyecto Terminal 2}
\renewcommand{\footrulewidth}{0.4pt}
\usepackage{graphics}
\usepackage{capt-of}
\usepackage[pdftex=false,colorlinks=true,plainpages=true,citecolor=blue,linkcolor=blue]{hyperref}
\setlength\parindent{0pt}
\usepackage[usenames]{color}
\usepackage{pdfpages}
\usepackage{float}
\usepackage{shapepar}

\begin{document}
\renewcommand{\tablename}{Tabla}
\renewcommand{\listtablename}{Índice de tablas}

\begin{titlepage}

\newcommand{\HRule}{\rule{\linewidth}{0.3mm}}

\includegraphics[scale=0.45]{imagenes/ipn}
\hspace{10cm}
\includegraphics[scale=0.15]{imagenes/upiita}
\\


\begin{center}


\textsc{\Large ``Sistema para el monitoreo, detección y alerta de somnolencia del conductor mediante visión artificial, comunicación inalámbrica y geolocalización''}\\[0.5cm]



\HRule \\[0.4cm]
{ \huge \bfseries Segundo Reporte Parcial}\\[0.4cm]

\HRule \\[1.5cm]

\begin{center}

Lista de actividades
 

\begin{itemize}
\item Maquetación web
\item Investigación de la documentación del módulo 3G/4G LTE-Base Hat  
\item Enlace de Amazon S3 con el sistema backend
\item Creación de los servicios backend
\item Familiarizarse con el entorno de desarrollo de la NVIDIA Jetson Nano
\item Implementar algoritmo para la detección del rostro y ojos
\item Implementar puntos faciales en el rostro y métrica MOR

\end{itemize}

\end{center}


\begin{minipage}{0.4\textwidth}
\begin{flushleft} \large
\emph{\\Autores:}\\
Alan Eduardo Gamboa Del Ángel\\
Maite Paulette Díaz Martínez\\

%Grupo:4MM6\\
\end{flushleft}
\end{minipage}
\begin{minipage}{0.5\textwidth}
\begin{flushright} \large
\emph{Asesores:} \\
M.en C. Niels Henrik Navarrete Manzanilla\\
Dr. Rodolfo Vera Amaro\\

\end{flushright}
\end{minipage}

\vfill

13 de Marzo 2023

\end{center}


\end{titlepage}
\newpage
\tableofcontents
\newpage
\listoffigures
\newpage
\listoftables

\newpage
\section{Maquetación web}

\subsection{Objetivo}
Definir e implementar las rutas que tendrá la aplicación, así como si serán públicas o privadas y la información que se desplegará en cada una de las mismas.




\subsection{Descripción}

\textbf{Rutas públicas vs rutas protegidas}

Cuando se habla de una ruta protegida en React, se referiere a programar un bloqueo en ciertas rutas a la cual se le restringe el acceso al usuario. Esto comunmente se realiza para la validación de inicio de sesión de usuarios. Sí el usuario no tiene una sesión iniciada, no podrá acceder a las rutas protegidas de la aplicación. Por otro lado, las rutas públicas son todas aquellas las cuales no requieren contar con una sesión iniciada, y pueden ser accesadas por cualquier tipo de usuario\cite{dom}.


Como primer paso, se necesita crear un proyecto de React utilizando el siguiente comando:


\begin{center}
  \includegraphics[scale=0.5]{imagenes/create}
\captionof{figure}{Creación proyecto de react}
 \label{fig:MongoA} 
\end{center} 


Posteriomente, se realiza la instalación del moudelo \emph{React Router Dom} utilizando el siguiente comando:

\begin{center}
  \includegraphics[scale=0.5]{imagenes/router}
\captionof{figure}{Instalación React Router DOM}
 \label{fig:MongoA} 
\end{center} 

Utilizando la librería \emph{useAuthenticator} ofrecida por el paquete de React Dom, crearemos un archivo de nombre \emph{RequireAuth.js} el cuál contendrá una función la cual se encargará de validar si existe una sesión iniciada previamente.

\begin{center}
  \includegraphics[scale=0.5]{imagenes/auth}
\captionof{figure}{Función RequireAuth}
 \label{fig:auth} 
\end{center} 

Posteriormente, se necesita contar con una página de Login, la cuál permitirá validar que se encuentre una sesión inciada por parte del usuario, para así poder acceder a las rutas protegidas.

\begin{center}
  \includegraphics[scale=0.6]{imagenes/loginjs}
\captionof{figure}{Componente Login}
 \label{fig:loginjs} 
\end{center} 


Para indicar a React, que se desea implementar una ruta protegida, se necesita ir al componente de dicha ruta e ingresar el siguiente código:


\begin{center}
  \includegraphics[scale=0.5]{imagenes/homejs}
\captionof{figure}{Ruta protegida del componente Home}
 \label{fig:homejs} 
\end{center} 

En dicho componente, se hace uso de las librerías \emph{useAuthenticator} y \emph{Authenticator} las cuales son ofrecidas por los servicios de Amazon Amplify. Se tendrá que hacer esto para todos los componentes que deseemos mantener como rutas protegidas.


Finalmente, dentro de nuestro componente \textbf{App.js}, crearemos una función que contendrá el directorio de rutas tanto públicas como protegidas:

\begin{center}
  \includegraphics[scale=0.5]{imagenes/routesjs}
\captionof{figure}{Directorio de rutas}
 \label{fig:routesjs} 
\end{center} 

Las rutas protedigas, estarán dentro de las etiquetas \textbf{<RequireAuth></RequireAuth>}, mientras que las públicas, irán dentro de las etiquetas \textbf{<Route></Route>}.


\subsection{Resultados}

Como resultado de todo lo anterior, tendrémos una página de Login que utilizando los servicios de AWS Amplify y Cognito, permitirá iniciar sesión así como registrar a nuevos usuarios.

\begin{center}
  \includegraphics[scale=0.4]{imagenes/loginpage}
\captionof{figure}{Página de Login}
 \label{fig:loginpage} 
\end{center} 

Si intentamos ingresar a las paginas de Conductores, Incidencias o Ubicacion, nos redigirá a la página de Login, debido a que estas páginas fueron definidas como rutas protegidas. Por lo tanto el usuario debe haber inciado sesión para poder acceder a las mismas.


\begin{itemize}
\item \textbf{Path:} "/\\ \textbf{Descripción:} En esta dirección se encontará la el formulario para poder iniciar sesión o registrarse

\item \textbf{Path:} "/home \\  \textbf{Descripción:} Esta dirección será la página principal de la aplicación dónde se mostrarán las incidencias más recientes así como una lista de todos los conductores

\item \textbf{Path:} "/conductor/\\ \textbf{Descripción:} Esta dirección mostrará el perfil del conductor de id correspondiente

\item \textbf{Path:} "/detalle\textunderscore incidencia \\ \textbf{Descripción:} Esta dirección mostrará cada incidencia mostrando detalles como hora, fecha, coordenadas

\item \textbf{Path:}  "/conductor/id/ubicacion \\ \textbf{Descripción:} En esta vista se mostrará la ubicación en tiempo real de cada conductor


\item \textbf{Path:} "/conductor/id/incidencias \\ \textbf{Descripción:} En esta vista se mostrará todas las incidencias registradas por cada conductor

\end{itemize}



\newpage
\section{Investigación de la documentación del módulo 3G/4G LTE-Base Hat} \label{base_hat}

\subsection{Objetivo}
Familiarizarse con las distintas funciones y comandos, así como el entorno de desarrollo que ofrece el dispositivo Base-Hat

\subsection{Descripción}

Para el presente proyecto, se hará uso del Base-Hat SIM7600G-H 4G para Jetson Nano. 

\begin{center}
  \includegraphics[scale=0.6]{imagenes/hat}
\captionof{figure}{Instalación Amplify CLI}
 \label{fig:hat} 
\end{center} 

En primer lugar, utilizando la terminal del sistema operativo Ubuntu, se ingresan los siguientes comandos:

\begin{center}
  \includegraphics[scale=0.6]{imagenes/libraries}
\captionof{figure}{Instalación de librerías}
 \label{fig:libraries} 
\end{center} 

Los comandos ingresados en la figura \ref{fig:libraries} se encargan de instalar todas las librarías y el software necesario para poder comenzar a utilizar la red LTE mediante el módulo SIM7600G-H. Además también se crea un directorio que contendrá la configuración de usuario así como un cuenta enlazada al módulo.

Posteriormente, probamos que el puerto GPIO de nuestra Jetson Nano esté funcionando con los siguientes comandos:

\begin{center}
  \includegraphics[scale=0.6]{imagenes/gpio}
\captionof{figure}{Instalación de librerías}
 \label{fig:gpio} 
\end{center}



Utilizando un editor de código, se necesita especificar que estará utilizando el \emph{SDK} de Amazon Amplify:

\begin{center}
  \includegraphics[scale=0.55]{imagenes/sdk}
\captionof{figure}{Implementación del SDK de Amplify}
 \label{fig:MongoA} 
\end{center} 

Posteriormente, declaramos una aplicación de ExpressJs la cuál nos permitirá ejecutar entre otras cosas, peticiones HTTP para la comunicación con la base de datos.

\begin{center}
  \includegraphics[scale=0.55]{imagenes/expressjs}
\captionof{figure}{Creación de aplicación de Express}
 \label{fig:MongoA} 
\end{center} 

Finalmente, se necesitan definir las rutas de las APIs que se estarán utilizando en el proyecto, las cuales serán dos, la primera se encargará de la aplicación web, y la segunda de realizar la comunicación con el Módulo Central de Procesamiento.

Para agregar una api, se necesita ejecutar el siguiente comando desde el directorio raíz del proyecto.


\begin{center}
  \includegraphics[scale=0.55]{imagenes/addapi}
\captionof{figure}{Amplify add api}
 \label{fig:MongoA} 
\end{center} 




	

\subsection{Resultados}

Como resultado, tenemos el endpoint de nuestro modelo de GraphQL y nuestra API Key generada por Amplify

\begin{center}
  \includegraphics[scale=0.55]{imagenes/endpoints}
\captionof{figure}{Generación de Endpoint de GraphQL}
 \label{fig:MongoA} 
\end{center} 


\newpage

\section{Enlace de Amazon S3 con el sistema backend}

\subsection{Objetivo}
Configurar e implementar la comunicación entre el sistema de alojamiento Amazon S3 y el sistema backend


\subsection{Descripción}
Utilizando un editor de código, y desde el directorio raíz de la aplicación, se deberá introducir el siguiente comando:

\begin{center}
  \includegraphics[scale=0.55]{imagenes/addstorage}
\captionof{figure}{Configuración de servicio de almacenamiento S3}
 \label{fig:addstorage} 
\end{center} 

Posteriormente, se requiere especificar que tipo de servicio de almacenamiento se integrará a la aplicación (multimedia o base de datos NoSQL). Para el presente proyecto, se utilizará el almacenamiento de contenido multimedia, por lo tanto, se seleccionará dicha opción.

\begin{center}
  \includegraphics[scale=0.55]{imagenes/content}
\captionof{figure}{Generación de Endpoint de GraphQL}
 \label{fig:MongoA} 
\end{center} 

Ingresamos el nombre de nuestro espacio de almacenamiento:

\begin{center}
  \includegraphics[scale=0.55]{imagenes/name}
\captionof{figure}{Generación de Endpoint de GraphQL}
 \label{fig:MongoA} 
\end{center}

Después, se necesita establecer cuantos usuarios, así como cuales podrán acceder a dicho servicio:

\begin{center}
  \includegraphics[scale=0.55]{imagenes/rules}
\captionof{figure}{Generación de Endpoint de GraphQL}
 \label{fig:MongoA} 
\end{center}


\begin{center}
  \includegraphics[scale=0.55]{imagenes/rulesauth}
\captionof{figure}{Generación de Endpoint de GraphQL}
 \label{fig:MongoA} 
\end{center}

\begin{center}
  \includegraphics[scale=0.55]{imagenes/guestrules}
\captionof{figure}{Generación de Endpoint de GraphQL}
 \label{fig:MongoA} 
\end{center}

\begin{center}
  \includegraphics[scale=0.55]{imagenes/push}
\captionof{figure}{Generación de Endpoint de GraphQL}
 \label{fig:MongoA} 
\end{center}



\subsection{Resultados}

Al ingresar a la consola de servicios de AWS, en la sección de buckets de S3, se puede observar que se encuentra el bucket recién creado llamado \emph{videos175126-dev}.


\begin{center}
  \includegraphics[scale=0.5]{imagenes/buckets}
\captionof{figure}{Tablas generadas mediante los schemas definidos}
 \label{fig:cognito} 
\end{center} 



\newpage
\section{Creación de los servicios backend}



\subsection{Objetivo}
Desarrollar los servicios que constituyen las funciones de la API, tales como obtención, creación y eliminación. Además, crear de los servicios que llevarán a cabo las funciones internas en la plataforma.

\subsection{Descripción}
Al estar trabajando con GraphQL dentro del proyecto, la manera en que se podrán realizar las operaciones \emph{CRUD - (Create, Read, Update, Delete)}, será mediante funciones JSON.

Para comprobar que la API permite dichas operaciones, se debe ingresar a la consola de AWS y dirigirse a la sección de AWS AppSync

\begin{center}
  \includegraphics[scale=0.4]{imagenes/appsync}
\captionof{figure}{Funcionamiento de Appsync}
 \label{fig:MongoA} 
\end{center} 

AWS AppSync crea las API sin servidor de GraphQL y de publicación o suscripción que simplifican el desarrollo de aplicaciones a través de un único punto de conexión para consultar, actualizar o publicar datos.

\subsection{Resultados}

Después de haber realizado los pasos de la sección \ref{Backend}, si ejecutamos el comando \emph{amplify status}, la consola de Amplify nos retornara el endpoint de GraphQL junto con AppSync correspondiente, el cuál se utilizará para realizar todas las operaciones con respecto al almacenamiento de datos

\begin{center}
  \includegraphics[scale=0.55]{imagenes/appsyncendpoint}
\captionof{figure}{Generación de endpoint de GraphQL}
 \label{fig:MongoA} 
\end{center} 


\newpage
\section{Familiarizarse con el entorno de desarrollo de la NVIDIA Jetson Nano}


\subsection{Objetivo}
Investigar la documentación ofrecida por NVIDIA sobre el uso y entorno de desarrollo de la jetson nano.
 
\subsection{Descripción}

\textbf{Instalación en la tarjeta microSD}

El Jetson Nano Developer Kit utiliza una tarjeta microSD como dispositivo de arranque y almacenamiento principal. Por tanto fue necesario instalar un entorno de desarrollo en la propia placa, para lo cual se requirio de una tarjeta microSD de un minímo recomendado de 32 GB de acuerdo a la documentación Nvidia.  \cite{Nvidia}.\\

Como primer paso se descargo el \emph{Jetson Nano Developer Kit SD Card Image} \cite{sdimage} y posteriormente se instalo en la tarjeta microSD desde el sistema operativo Linux, utilizando los siguentes pasos:
\begin{enumerate}

\item Se abrio una terminal y se inserto la tarjeta microSD. 
\item Se uso el siguiente comando para mostrar que dispositivo de disco se le asignó:

\begin{verbatim}
dmesg | tail | awk '\$3 == "sd" {print}'
\end{verbatim}


\item Se  escribio la imagen de la tarjeta SD comprimida (previamente descargada) en la tarjeta microSD con el comando:

\begin{verbatim}
/usr/bin/unzip -p ~/Downloads/jetson_nano_devkit_sd_card.zip | 
sudo /bin/dd of=/dev/sda bs=1M status=progress
\end{verbatim}

\item Finalmente se expulso del dispositivo de disco desde la linea de comando utilizando:

\begin{verbatim}
sudo eject /dev/sda
\end{verbatim}
\end{enumerate}

\textbf{Configuración y primer arranque}\\

Jetson Nano Developer Kit permite dos formas de interactuar, la primera es por medio de otra computadora y la segunda haciendo uso de una pantalla, teclado y mouse conectados. Adicionalmente el kit de desarrollo no cuenta con una fuente de alimentación incluida por lo que se utilizó  una fuente de alimentación Micro-USB(5V-2A).\\

Para iniciar el kit de desarrollo se conectó el mouse, la pantalla, el teclado y la funete de alimentación, posteriormente se realizó la configuración inicial del sistema operativo el cual incluyó lo siguiente:

\begin{itemize}
\item Revisar y acepter el EULA del software NVIDIA Jetson.
\item Seleccionar el idioma del sistema, la distribución del teclado y la zona horaria
\item Crear nombre de usuario, contraseña y nombre de la computadora.
\item Seleccione el tamaño de partición de la aplicación: se recomienda utilizar el tamaño máximo sugerido.
\end{itemize}





\begin{center}
  \includegraphics[scale=0.5]{imagenes/cognito}
\captionof{figure}{Funcionamiento de Amazon Cognito}
 \label{fig:cognito} 
\end{center} 




\subsection{Resultados}







\newpage
\section{Implementar algoritmo para la detección del rostro y ojos  }


\subsection{Objetivo}
realizar la detección de rostro y ojos en la Jetson Nano .

\subsection{Descripción}



\subsection{Resultados}



\clearpage
\section{Implementar puntos faciales en el rostro y la metrica MOR}

\subsection{Objetivo}
Implementar la detección con puntos faciales en el rostro y la metrica mor para detectar si la boca se encuentra abierta o cerrada.

\subsection{Descripción}




\subsection{Resultados}


\newpage
\section{Conclusiones}




\newpage
\section{Bibliografia}
%\bibliographystyle{apacite}

\begin{thebibliography}{10} %10 significa el número máximo de items
%Aquí ponga la bibliografía y referencias usadas

%Artículo:

\bibitem{dom}F. Martinez. \emph{Protección de rutas con React Router Dom}, DEV Community. https://dev.to/franklin030601/proteccion-de-rutas-con-react-router-dom-144j (accedido el 7 de marzo de 2023).

\bibitem{dynamo} \emph{¿Qué es Amazon DynamoDB?}, Amazon Docs. https://docs.aws.amazon.com/es-es/amazondynamodb/latest/developerguide/Introduction.html (accedido el 2 de marzo de 2023).

\bibitem{appsync} \emph{API sin servidor de GraphQL y de publicación o suscripción $-$ AWS AppSync $-$ Amazon Web Services}. Amazon Web Services, Inc. https://aws.amazon.com/es/appsync/ (accedido el 12 de marzo de 2023).  

\bibitem{cognito} \emph{AWS | Gestión de identidades y autenticación de usuario en la nube}, Amazon Web Services, Inc. https://aws.amazon.com/es/cognito/ (accedido el 8 de marzo de 2023).






\bibitem{Nvidia} NVIDIA, "Get Started with the Jetson Nano Developer Kit", NVIDIA Developer, 2019. [Online]. Disponible: https://developer.nvidia.com/embedded/learn/get-started-jetson-nano-devkit\#intro. [Accedido: Abril 02 2023].

\bibitem{sdimage} Nvidia Developer, "Get Started with Jetson Nano Devkit," Nvidia Developer. [En línea]. Disponible: https://developer.nvidia.com/embedded/learn/get-started-jetson-nano-devkit\#write. [Accedido: 2 de abril de 2023].

\bibitem{JetsonInf}Dusty, N. "Building the Repo - NVIDIA Jetson Inference," GitHub. [Online]. Disponible en: https://github.com/dusty-nv/jetson-inference/blob/master/docs/building-repo-2.md. [Accedido en: 02-abr-2023].




\end{thebibliography}


\end{document}


